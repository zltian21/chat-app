(this["webpackJsonpchat-app-frontend"]=this["webpackJsonpchat-app-frontend"]||[]).push([[0],{109:function(e,t,n){},224:function(e,t,n){},245:function(e,t,n){},386:function(e,t,n){},387:function(e,t,n){},388:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(32),c=n.n(a),s=n(22),o=n(206),i=n(30),l=n(17),u=n.n(l),d=n(26),j=n(28),O=n(55),b=n(393),m=n(396),h=n(48),p=n(99),f=(n(224),n(4));function v(e){return Object(f.jsx)("div",{className:"layout",children:Object(f.jsxs)("div",{className:"child-container",children:[Object(f.jsxs)("div",{className:"heading",children:[Object(f.jsxs)("div",{className:"apple-ops",children:[Object(f.jsx)("span",{}),Object(f.jsx)("span",{}),Object(f.jsx)("span",{})]}),Object(f.jsx)("span",{className:"title",children:"Chat App by team-Rice"})]}),e.children]})})}var x,g,E,y=n(9);!function(e){e[e.ACCEPTED=0]="ACCEPTED",e[e.DECLINED=1]="DECLINED",e[e.NO_STATUS=2]="NO_STATUS"}(x||(x={})),function(e){e.USER_LOGIN="USER_LOGIN",e.USER_REGISTER="USER_REGISTER",e.USER_LOGOUT="USER_LOGOUT",e.USER_UPDATE="USER_UPDATE",e.USER_ERROR="USER_ERROR",e.USER_LOADING="USER_LOADING",e.FETCH_NOTIFICATION="FETCH_NOTIFICATION",e.UPDATE_NOTIFICATION="UPDATE_NOTIFICATION",e.FETCH_CHATROOM_LIST="FETCH_CHATROOM_LIST",e.LOADING_CHATROOM="LOADING_CHATROOM",e.SET_SIDEBAR_TAB="SET_SIDEBAR_TAB",e.LEAVE_ALL_ROOMS="LEAVE_ALL_ROOMS",e.HAVE_NEW_MESSAGE="HAVE_NEW_MESSAGE",e.CLEAR_NEW_MESSAGE="CLEAR_NEW_MESSAGE",e.OPEN_WARNING_PANEL="OPEN_WARNING_PANEL",e.CLOSE_WARNING_PANEL="CLOSE_WARNING_PANEL",e.RECONNECT_WEBSOCKET="RECONNECT_WEBSOCKET"}(g||(g={})),function(e){e.ACTIVE_ROOM="ACTIVE_ROOM",e.FETCH_ROOM="FETCH_ROOM",e.FETCH_ROOM_LOADING="FETCH_ROOM_LOADING",e.CANCEL_LOADING="CANCEL_LOADING",e.FETCH_NORMAL_USERS="FETCH_NORMAL_USERS",e.FETCH_BLOCKED_USERS="FETCH_BLOCKED_USERS",e.FETCH_USERS_LOADING="FETCH_USERS_LOADING",e.FETCH_USERS_END_LOADING="FETCH_USERS_END_LOADING",e.SET_PRIVATE_MESSAGE="SET_PRIVATE_MESSAGE",e.UNSET_PRIVATE_MESSAGE="UNSET_PRIVATE_MESSAGE",e.NEW_MESSAGE="NEW_MESSAGE",e.EDIT_MESSAGE="EDIT_MESSAGE",e.REMOVE_MESSAGE="REMOVE_MESSAGE",e.LEAVE_ROOM="LEAVE_ROOM"}(E||(E={}));var S=n(213),N=n(196),I=n.n(N),T=n(197),_=n.n(T),R=n(147),A=n(198),C=n(83),L={currentRoom:null,messages:[],messageLoading:!1,normalUsers:[],blockedUsers:[],fetchUsersLoading:!1,isAdmin:!1,isBlocked:!1,isPrivate:!1,isPrivateMessage:!1,privateMessageTo:null},k=function(e){var t=location.protocol.includes("https")?"wss":"ws",n=new WebSocket("".concat(t,"://").concat(location.hostname,":").concat(location.port,"/chatapp?username=").concat(e));return n.onopen=function(){console.log("Websocket Established")},n.onmessage=function(e){var t,n=e.data,r=JSON.parse(n);(null===(t=U.getState().room.currentRoom)||void 0===t?void 0:t.chatRoomId)===r.chatRoomId?"edit"===r.type?U.dispatch({type:E.EDIT_MESSAGE,payload:r}):"remove"===r.type?U.dispatch({type:E.REMOVE_MESSAGE,payload:r}):U.dispatch({type:E.NEW_MESSAGE,payload:r}):U.dispatch({type:g.HAVE_NEW_MESSAGE,payload:r.chatRoomId})},n.onclose=function(){console.log("Websocket Closed"),U.dispatch({type:g.RECONNECT_WEBSOCKET})},n.onerror=function(e){S.a.error({message:"Websocket Error"}),console.log(e)},n},w={token:localStorage.getItem("token"),isAuthenticated:!!localStorage.getItem("token"),user:null,notifications:[],roomList:[],roomListLoading:!1,sidebarTab:"my",isLoading:!1,ws:null,closedWarningPanel:!1},M=Object(R.b)({user:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,n=arguments.length>1?arguments[1]:void 0,r=n.type,a=n.payload;switch(r){case g.USER_LOGIN:case g.USER_REGISTER:return localStorage.setItem("token","".concat(a.id)),null===(e=t.ws)||void 0===e||e.close(),Object(y.a)(Object(y.a)({},t),{},{token:"".concat(a.id),isAuthenticated:!0,user:a,sidebarTab:"my",isLoading:!1,ws:k(a.username)});case g.USER_LOADING:return Object(y.a)(Object(y.a)({},t),{},{isLoading:!0});case g.USER_LOGOUT:return localStorage.removeItem("token"),Object(y.a)(Object(y.a)({},t),{},{user:null,token:null,isAuthenticated:!1,notifications:[],roomList:[],ws:null});case g.USER_UPDATE:return Object(y.a)(Object(y.a)({},t),{},{user:a,ws:t.ws?t.ws:k(a.username)});case g.USER_ERROR:return Object(y.a)(Object(y.a)({},t),{},{isLoading:!1});case g.FETCH_NOTIFICATION:return Object(y.a)(Object(y.a)({},t),{},{notifications:a});case g.UPDATE_NOTIFICATION:var c=t.notifications.findIndex((function(e){return e.id===a.id})),s=Object(C.a)(t.notifications);return s[c].status=a.status,Object(y.a)(Object(y.a)({},t),{},{notifications:s});case g.FETCH_CHATROOM_LIST:return Object(y.a)(Object(y.a)({},t),{},{roomList:a.map((function(e){return Object(y.a)(Object(y.a)({},e),{},{hasNewMessage:!1})})),roomListLoading:!1});case g.LOADING_CHATROOM:return Object(y.a)(Object(y.a)({},t),{},{roomListLoading:!0});case g.SET_SIDEBAR_TAB:return Object(y.a)(Object(y.a)({},t),{},{sidebarTab:a});case g.LEAVE_ALL_ROOMS:return Object(y.a)(Object(y.a)({},t),{},{roomList:[]});case g.CLOSE_WARNING_PANEL:return Object(y.a)(Object(y.a)({},t),{},{closedWarningPanel:!0});case g.OPEN_WARNING_PANEL:return Object(y.a)(Object(y.a)({},t),{},{closedWarningPanel:!1});case g.HAVE_NEW_MESSAGE:var o=Object(C.a)(t.roomList);return o.find((function(e){return e.chatRoomId===a.chatRoomId})).hasNewMessage=!0,Object(y.a)(Object(y.a)({},t),{},{roomList:o});case g.CLEAR_NEW_MESSAGE:var i=Object(C.a)(t.roomList);return i.find((function(e){return e.chatRoomId===a})).hasNewMessage=!1,Object(y.a)(Object(y.a)({},t),{},{roomList:i});case g.RECONNECT_WEBSOCKET:return Object(y.a)(Object(y.a)({},t),{},{ws:t.user?k(t.user.username):null});default:return t}},room:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case E.ACTIVE_ROOM:return Object(y.a)(Object(y.a)({},e),{},{currentRoom:r});case E.SET_PRIVATE_MESSAGE:return Object(y.a)(Object(y.a)({},e),{},{isPrivateMessage:!0,privateMessageTo:r});case E.UNSET_PRIVATE_MESSAGE:return Object(y.a)(Object(y.a)({},e),{},{isPrivateMessage:!1,privateMessageTo:null});case E.FETCH_ROOM:return Object(y.a)(Object(y.a)({},e),{},{messages:r.messages,isAdmin:r.isAdmin,isBlocked:r.isBlocked,isPrivate:r.isPrivate,messageLoading:!1});case E.FETCH_ROOM_LOADING:return Object(y.a)(Object(y.a)({},e),{},{messageLoading:!0});case E.CANCEL_LOADING:return Object(y.a)(Object(y.a)({},e),{},{messageLoading:!1});case E.FETCH_NORMAL_USERS:return Object(y.a)(Object(y.a)({},e),{},{normalUsers:r});case E.FETCH_BLOCKED_USERS:return Object(y.a)(Object(y.a)({},e),{},{blockedUsers:r});case E.FETCH_USERS_LOADING:return Object(y.a)(Object(y.a)({},e),{},{fetchUsersLoading:!0});case E.FETCH_USERS_END_LOADING:return Object(y.a)(Object(y.a)({},e),{},{fetchUsersLoading:!1});case E.NEW_MESSAGE:return Object(y.a)(Object(y.a)({},e),{},{messages:[].concat(Object(C.a)(e.messages),[r])});case E.EDIT_MESSAGE:var a=Object(C.a)(e.messages);return a.find((function(e){return e.messageId===r.messageId})).content=r.content,Object(y.a)(Object(y.a)({},e),{},{messages:a});case E.REMOVE_MESSAGE:var c=Object(C.a)(e.messages);return c.splice(e.messages.findIndex((function(e){return e.messageId===r.messageId})),1),Object(y.a)(Object(y.a)({},e),{},{messages:c});case E.LEAVE_ROOM:return Object(y.a)(Object(y.a)({},e),{},{currentRoom:null,messages:[],messageLoading:!1,normalUsers:[],blockedUsers:[],isAdmin:!1,isPrivateMessage:!1,isBlocked:!1,isPrivate:!1,privateMessageTo:null});default:return e}}}),U=Object(R.c)(M,Object(R.a)(A.a)),P=I.a.create({baseURL:"https://chatapp-final-team-rice.herokuapp.com"});P.interceptors.request.use((function(e){return e.headers&&(e.headers["Content-Type"]="application/x-www-form-urlencoded",e.headers["Access-Control-Allow-Origin"]="*",localStorage.getItem("token")&&(e.headers.userId=localStorage.getItem("token"))),e})),P.interceptors.response.use((function(e){if(0!==e.data.errCode)throw S.a.error({message:e.data.errMsg}),new Error("".concat(e.data.errMsg));return e}),(function(e){var t=e.response;if(!t)throw S.a.error({message:e.message}),new Error("".concat(e.message));throw 500===t.status?S.a.error({message:"Server Error"}):401===t.status?(S.a.error({message:t.data}),U.dispatch({type:g.USER_LOGOUT}),U.dispatch({type:E.LEAVE_ROOM})):S.a.error({message:t.data}),new Error("".concat(t.data))}));var G=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.request({method:t.method,url:t.url,data:"GET"===t.method?null:_.a.stringify(t.body||{}),headers:t.header});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=G,F=function(e,t){return function(){var n=Object(d.a)(u.a.mark((function n(r){var a,c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r({type:g.USER_LOADING}),n.next=4,D({method:"POST",url:"/login",body:{username:e,password:t}});case 4:a=n.sent,c=a.data,r({type:g.USER_LOGIN,payload:c[0]}),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),console.log(n.t0.message),r({type:g.USER_ERROR});case 13:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()},H=function(e){return function(){var t=Object(d.a)(u.a.mark((function t(n){var r,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:g.USER_LOADING}),t.next=4,D({method:"POST",url:"/register",body:Object(y.a)({},e)});case 4:r=t.sent,a=r.data,n({type:g.USER_REGISTER,payload:a[0]}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0.message),n({type:g.USER_ERROR,payload:t.t0.message});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},V=function(e){return function(){var t=Object(d.a)(u.a.mark((function t(n,r){var a,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D({method:"GET",url:"/getUserInfo/".concat(e||r().user.token)});case 3:a=t.sent,c=a.data,n({type:g.USER_UPDATE,payload:c[0]}),r().user.user&&c[0].hateSpeechCount>r().user.user.hateSpeechCount&&n({type:g.OPEN_WARNING_PANEL}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}()},z=function(e,t){return function(n){n({type:g.UPDATE_NOTIFICATION,payload:{id:e,status:t?x.ACCEPTED:x.DECLINED}})}},W=function(e){return function(){var t=Object(d.a)(u.a.mark((function t(n){var r,a,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r="my"===e?"/getMyChatrooms":"/getPublicChatrooms",n({type:g.LOADING_CHATROOM}),t.next=5,D({method:"GET",url:r});case 5:a=t.sent,c=a.data,n({type:g.FETCH_CHATROOM_LIST,payload:c}),n({type:g.SET_SIDEBAR_TAB,payload:e}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0.message);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()};n(245);function B(e){var t=Object(p.useForm)(),n=Object(j.a)(t,1)[0],a=Object(s.b)(),c=Object(s.c)((function(e){return e.user})),o=c.isAuthenticated,i=c.isLoading;Object(r.useEffect)((function(){o&&e.history.push("/main")}),[o]);var l=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.validateFields();case 3:e.sent&&(t=n.getFieldsValue(),a(F(t.username,t.password))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(f.jsx)(v,{children:Object(f.jsxs)("div",{className:"login",children:[Object(f.jsx)("div",{className:"left"}),Object(f.jsxs)("div",{className:"right",children:[Object(f.jsx)("h1",{children:"LOGIN"}),Object(f.jsxs)(b.a,{form:n,requiredMark:!1,className:"form",onSubmitCapture:l,children:[Object(f.jsx)(b.a.Item,{name:"username",rules:[{required:!0,message:"This field cannot be empty"}],children:Object(f.jsx)(m.a,{placeholder:"Username",size:"large",prefix:Object(f.jsx)(O.g,{})})}),Object(f.jsx)(b.a.Item,{name:"password",rules:[{required:!0,message:"This field cannot be empty"}],children:Object(f.jsx)(m.a,{type:"password",placeholder:"Password",size:"large",prefix:Object(f.jsx)(O.d,{})})}),Object(f.jsxs)("div",{style:{marginTop:"3rem"},children:[Object(f.jsx)(h.a,{type:"primary",shape:"round",htmlType:"submit",size:"large",style:{minWidth:"8rem",height:"3rem"},loading:i,children:"Login"}),Object(f.jsx)(h.a,{type:"link",size:"large",onClick:function(){return e.history.push("/register")},children:"Register"})]})]})]})]})})}var q=n(202),K=n(397),Y=n(204),J=n(401),X=n(79),Q=n(399),Z=n(88),$=n(409),ee=n(392),te=n(38),ne=n(106),re=n(407),ae=n(408);n(109);function ce(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.user.notifications})),n=Object(s.c)((function(e){return e.user.sidebarTab})),r=function(){var t=Object(d.a)(u.a.mark((function t(r,a){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D({method:"POST",url:"/opInvitation/".concat(r),body:{accept:a}});case 3:e(z(r,a)),a&&"my"===n&&e(W("my")),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n){return t.apply(this,arguments)}}(),a=function(e){var t=e.id,n=e.type,a=e.status;return"invite"===n?Object(f.jsx)("div",{className:"operation",children:a===x.NO_STATUS?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(h.a,{danger:!0,shape:"circle",size:"small",icon:Object(f.jsx)(te.a,{}),onClick:function(){return r(t,!1)}})," ",Object(f.jsx)(h.a,{type:"primary",shape:"circle",size:"small",icon:Object(f.jsx)(ne.a,{}),onClick:function(){return r(t,!0)}})]}):a===x.ACCEPTED?Object(f.jsx)("span",{children:"Accepted"}):Object(f.jsx)("span",{children:"Declined"})}):null},c=function(e){var t=e.indexOf("["),n=e.match(/\[(.*)\]/);return Object(f.jsxs)(f.Fragment,{children:[e.substring(0,t)," ",Object(f.jsx)("strong",{children:n[1]})]})};return Object(f.jsx)("div",{className:"notifications-list",children:Object(f.jsx)(ee.b,{dataSource:t,renderItem:function(e){return Object(f.jsxs)(ee.b.Item,{className:"notification-item",children:[Object(f.jsxs)("div",{className:"info",children:["invite"===e.type?Object(f.jsx)(re.a,{className:"bell",color:"#ccc"}):Object(f.jsx)(ae.a,{className:"bell",color:"#ccc"}),c(e.content)]}),a(e)]})}})})}var se=["#f56a00","#7265e6","#ffbf00","#00a2ae","#00ae0e","#9c35b1","#0da887","#0d77a8"],oe=se.length,ie=function(e){return se[e||Math.floor(Math.random()*se.length)]};function le(e){var t=Object(s.b)(),n=Object(s.c)((function(e){return e.user})),a=n.user,c=n.sidebarTab,o=n.notifications,i=n.closedWarningPanel,l=Object(r.useState)(!1),b=Object(j.a)(l,2),m=b[0],h=b[1];Object(r.useEffect)((function(){var e;if(a){var n=function(){t(V()),t(function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D({method:"GET",url:"/getUserNotification"});case 3:n=e.sent,r=n.data,t({type:g.FETCH_NOTIFICATION,payload:r}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())};n(),e=setInterval(n,3e3),t(W("my"))}return function(){return clearInterval(e)}}),[]),Object(r.useEffect)((function(){a&&(a.hateSpeechCount>=5&&a.hateSpeechCount<10&&!i?(K.a.confirm({title:"Warning",icon:Object(f.jsx)(Z.a,{}),content:"You have been detected sending hate speech ".concat(a.hateSpeechCount," times. Over 10 times and you will be banned from this app."),centered:!0}),t({type:g.CLOSE_WARNING_PANEL})):a.hateSpeechCount>=10&&!i&&(K.a.confirm({title:"Banned",icon:Object(f.jsx)($.a,{}),content:"You have exceeded the maximum of speech count. You will be forced to logout and banned",centered:!0,closable:!1,cancelText:"",onOk:function(){t({type:g.USER_LOGOUT})},onCancel:function(){t({type:g.USER_LOGOUT})}}),t({type:g.CLOSE_WARNING_PANEL})))}),[a]);var p=function(e){t(W(e))};return Object(f.jsxs)("div",{className:"sidebar",children:[Object(f.jsx)(Y.a,{trigger:"hover",placement:"rightTop",arrowContent:!0,content:Object(f.jsxs)("div",{className:"user-info",children:[Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{children:"Username:"})," ",null===a||void 0===a?void 0:a.username]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{children:"Age:"})," ",null===a||void 0===a?void 0:a.age]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{children:"School:"})," ",null===a||void 0===a?void 0:a.schoolName]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{children:"Interests:"})," ",null===a||void 0===a?void 0:a.interests]}),Object(f.jsx)("hr",{}),Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{children:"HSC:"})," ",null===a||void 0===a?void 0:a.hateSpeechCount]})]}),children:Object(f.jsx)(J.a,{size:64,src:null===a||void 0===a?void 0:a.imageUrl,style:{backgroundColor:ie((null===a||void 0===a?void 0:a.id)||0%oe)}})}),Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{className:"".concat("my"===c?"active":""),children:Object(f.jsx)(X.a,{placement:"left",title:"Chatrooms I Joined",children:Object(f.jsx)(Q.a,{children:Object(f.jsx)(O.b,{size:30,onClick:function(){return p("my")}})})})}),Object(f.jsx)("li",{className:"".concat("public"===c?"active":""),children:Object(f.jsx)(X.a,{placement:"left",title:"Other Public Chatrooms",children:Object(f.jsx)(Q.a,{children:Object(f.jsx)(O.c,{size:30,onClick:function(){return p("public")}})})})}),Object(f.jsx)("li",{className:m?"active":"",children:Object(f.jsx)(Y.a,{trigger:"click",placement:"right",title:"Notifications",arrowContent:!0,content:Object(f.jsx)(ce,{}),onVisibleChange:h,children:Object(f.jsx)(Q.a,{count:o.filter((function(e){return"invite"===e.type&&e.status===x.NO_STATUS})).length,children:Object(f.jsx)(O.a,{size:30})})})}),Object(f.jsx)("li",{children:Object(f.jsx)(X.a,{placement:"left",title:"Log out",children:Object(f.jsx)(O.f,{style:{transform:"rotate(180deg)",marginTop:"auto"},size:30,onClick:function(){e.history.push("/login"),t(function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D({method:"GET",url:"/logout"});case 3:t({type:g.USER_LOGOUT}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}())}})})})]})]})}var ue=n(146),de=n(57),je=n(214),Oe=n(404),be=n(390),me=n(402),he=n(215);function pe(e){var t,n,a,c=e.own,s=e.isAdmin,o=e.message,i=e.onMessageChange,l=e.onMessageDelete,u=Object(r.useState)(!1),d=Object(j.a)(u,2),O=d[0],b=d[1],h=Object(r.useState)(""),p=Object(j.a)(h,2),v=p[0],x=p[1],g=function(e){13===e.which&&!e.shiftKey&&v&&(e.preventDefault(),i(o.messageId,v))},E=function(){return Object(f.jsxs)("div",{className:"message-operation",children:[Object(f.jsx)("span",{onClick:function(){b(!0),x(o.content)},children:"Edit"}),Object(f.jsx)(be.a,{type:"vertical"}),Object(f.jsx)("span",{onClick:function(){return l(o.messageId)},children:"Remove"}),O&&Object(f.jsx)(m.a,{value:v,onChange:function(e){return x(e.target.value)},onKeyPress:g})]})};return"system"===o.type?Object(f.jsx)(me.a,{message:o.content,type:"warning",showIcon:!0,style:{marginBottom:"1rem"}}):c?Object(f.jsxs)("div",{className:"message-item me",children:[Object(f.jsxs)("div",{className:"info",children:[Object(f.jsxs)("div",{className:"name",children:[o.isPrivate&&Object(f.jsxs)("span",{style:{color:"rgb(93, 52, 139)"},children:["Private to ",o.receiver.userName,Object(f.jsx)(he.a,{style:{margin:"0 1rem"}})]}),o.sender.userName]}),Object(f.jsx)(Y.a,{content:E(),trigger:"click",onVisibleChange:function(e){return!e&&b(!1)},children:Object(f.jsx)("div",{className:"text",children:o.content})})]}),Object(f.jsx)(J.a,{size:"large",src:o.sender.userAvatar,style:{marginTop:".3rem",backgroundColor:ie(o.sender.userId%oe)},children:o.sender.userName[0]})]},o.messageId):Object(f.jsxs)("div",{className:"message-item",children:[Object(f.jsx)(J.a,{size:"large",src:null===(t=o.sender)||void 0===t?void 0:t.userAvatar,style:{marginTop:".3rem",backgroundColor:ie(o.sender.userId%oe)},children:null===(n=o.sender)||void 0===n?void 0:n.userName[0]}),Object(f.jsxs)("div",{className:"info",children:[Object(f.jsxs)("div",{className:"name",children:[null===(a=o.sender)||void 0===a?void 0:a.userName,o.isPrivate&&Object(f.jsxs)("span",{style:{color:"rgb(93, 52, 139)"},children:[Object(f.jsx)(he.a,{style:{margin:"0 1rem"}}),"Private to ME"]})," "]}),s?Object(f.jsx)(Y.a,{content:E(),trigger:"click",children:Object(f.jsxs)("div",{className:"text",children:[" ",o.content]})}):Object(f.jsxs)("div",{className:"text",children:[" ",o.content]})]})]},o.messageId)}var fe=function(e){return function(){var t=Object(d.a)(u.a.mark((function t(n){var r,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D({method:"GET",url:"/getListofUser/".concat(e)});case 3:return r=t.sent,n({type:E.FETCH_NORMAL_USERS,payload:r.data}),t.next=7,D({method:"GET",url:"/getListofBlockedUser/".concat(e)});case 7:a=t.sent,n({type:E.FETCH_BLOCKED_USERS,payload:a.data}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0.message);case 14:return t.prev=14,n({type:E.FETCH_USERS_END_LOADING}),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[0,11,14,17]])})));return function(e){return t.apply(this,arguments)}}()};function ve(e){var t=Object(s.b)(),n=Object(s.c)((function(e){return e.user})).user,a=Object(s.c)((function(e){return e.room})),c=a.currentRoom,o=a.messages,i=a.messageLoading,l=a.isPrivateMessage,O=a.privateMessageTo,b=a.isBlocked,p=a.isAdmin,v=Object(r.useRef)(null),x=Object(r.useState)(""),g=Object(j.a)(x,2),S=g[0],N=g[1],I=Object(r.useState)(!1),T=Object(j.a)(I,2),_=T[0],R=T[1];Object(r.useEffect)((function(){var e;c&&t((e=c.chatRoomId,function(){var t=Object(d.a)(u.a.mark((function t(n){var r,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:E.FETCH_ROOM_LOADING}),t.next=4,D({method:"GET",url:"/getChatRoom/".concat(e)});case 4:r=t.sent,a=r.data,n({type:E.FETCH_ROOM,payload:a[0]}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0.message);case 12:return t.prev=12,n({type:E.CANCEL_LOADING}),t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})));return function(e){return t.apply(this,arguments)}}()))}),[c]),Object(r.useEffect)((function(){(null===v||void 0===v?void 0:v.current)&&!_&&v.current.scrollIntoView({behavior:"smooth"})}),[o]),Object(r.useEffect)((function(){_&&setTimeout((function(){return R(!1)}),2e3)}),[_]);var A=function(e,n){var r,a,s;t((r=e,a=n,s=c.chatRoomId,Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D({method:"POST",url:"/editMessage",body:{messageId:r,content:a,chatRoomId:s}});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))))},C=function(e){var n,r;t((n=e,r=c.chatRoomId,Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D({method:"POST",url:"/removeMessage",body:{messageId:n,chatRoomId:r}});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))))};return c?Object(f.jsxs)("div",{className:"chat-panel",children:[Object(f.jsxs)("div",{className:"header",children:[Object(f.jsx)("h3",{children:c.chatRoomName}),c.isPrivate?Object(f.jsx)(Oe.a,{color:"blue",children:"Private"}):Object(f.jsx)(Oe.a,{color:"green",children:"Public"}),Object(f.jsx)(h.a,{type:"link",icon:Object(f.jsx)(ue.a,{style:{fontSize:32}}),style:{marginLeft:"auto"},onClick:function(){return e.openDrawer()}})]}),Object(f.jsxs)("div",{className:"message-panel",onScroll:function(){return R(!0)},children:[i?Object(f.jsx)(q.a,{style:{position:"absolute",left:"50%",top:"2rem",transform:"translateX(-50%)"}}):Object(f.jsx)(f.Fragment,{children:o.map((function(e){var t;return Object(f.jsx)(pe,{message:e,isAdmin:p,own:(null===(t=e.sender)||void 0===t?void 0:t.userId)===(null===n||void 0===n?void 0:n.id),onMessageChange:A,onMessageDelete:C},e.messageId)}))}),Object(f.jsx)("div",{style:{float:"left",clear:"both"},ref:v})]}),Object(f.jsxs)("div",{className:"operation-panel",children:[l&&Object(f.jsxs)("div",{className:"private-banner",children:[Object(f.jsx)(de.a,{onClick:function(){t({type:E.UNSET_PRIVATE_MESSAGE})}}),"Private Message to ",O.userName]}),Object(f.jsx)(m.a.TextArea,{disabled:b,placeholder:b?"You are blocked":"",onKeyPress:function(e){var r;b?je.b.error("You are blocked"):13===e.which&&!e.shiftKey&&S&&(e.preventDefault(),t((r={messageId:Math.random(),content:S,isPrivate:l,sender:{userId:n.id,userName:n.username,userAvatar:n.imageUrl},type:"new",receiver:O},function(e,t){var n,a,c=t().user.ws,s=t().room.currentRoom,o=Object(y.a)(Object(y.a)({},r),{},{senderId:null===(n=r.sender)||void 0===n?void 0:n.userId,receiverId:(null===(a=r.receiver)||void 0===a?void 0:a.userId)||-1,roomId:null===s||void 0===s?void 0:s.chatRoomId});null===c||void 0===c||c.send(JSON.stringify(o))})),N(""))},value:S,onChange:function(e){return N(e.target.value)},showCount:!0,maxLength:100,rows:l?6:7})]})]}):Object(f.jsxs)("div",{className:"placeholder-panel",children:[Object(f.jsx)("h1",{children:"Select a room to start chatting!"}),Object(f.jsx)("img",{src:"https://res.cloudinary.com/rylanzhou/image/upload/v1635557590/COMP%20504/undraw_Anonymous_feedback_re_rc5v_zn7vcm.png",alt:"Placeholder"})]})}var xe=n(395),ge=n(405),Ee=n(410),ye=function(){return Object(f.jsx)("div",{style:{position:"absolute",width:"100%",height:"100%",zIndex:100,backgroundColor:"rgba(255, 255, 255, 0.3)"},children:Object(f.jsx)(q.a,{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}})})};function Se(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.user.roomList})),n=Object(s.c)((function(e){return e.user.roomListLoading})),a=Object(s.c)((function(e){return e.user.sidebarTab})),c=Object(s.c)((function(e){return e.room.currentRoom})),o=Object(p.useForm)(),i=Object(j.a)(o,1)[0],l=Object(r.useState)(!1),O=Object(j.a)(l,2),v=O[0],x=O[1],y=Object(r.useState)(!1),S=Object(j.a)(y,2),N=S[0],I=S[1],T=function(){var t=Object(d.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.validateFields();case 3:if(!t.sent){t.next=10;break}return I(!0),t.next=8,D({method:"POST",url:"/createRoom",body:i.getFieldsValue()});case 8:"my"===a&&e(W("my")),x(!1);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0.message);case 15:return t.prev=15,I(!1),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[0,12,15,18]])})));return function(){return t.apply(this,arguments)}}(),_=function(){var n=Object(d.a)(u.a.mark((function n(r){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,"public"!==a){n.next=4;break}return n.next=4,D({method:"POST",url:"/joinRoom",body:{chatRoomId:r}});case 4:e({type:E.ACTIVE_ROOM,payload:t.find((function(e){return e.chatRoomId===r}))}),e({type:g.CLEAR_NEW_MESSAGE,payload:r}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0.message);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}();return Object(f.jsxs)("div",{className:"rooms-list",children:[Object(f.jsx)(h.a,{type:"dashed",size:"large",icon:Object(f.jsx)(Ee.a,{}),style:{margin:"0 1rem"},onClick:function(){return x(!0)},children:"Create a Room"}),Object(f.jsxs)("div",{className:"list",children:[n&&Object(f.jsx)(ye,{}),t.map((function(e){return Object(f.jsx)(Ne,{name:e.chatRoomName,id:e.chatRoomId,hasNewMessage:e.hasNewMessage,isActive:(null===c||void 0===c?void 0:c.chatRoomId)===e.chatRoomId,isPrivate:e.isPrivate,onClick:_},e.chatRoomId)}))]}),Object(f.jsx)(h.a,{type:"primary",color:"danger",danger:!0,onClick:function(){K.a.confirm({title:"Are you sure to leave all rooms?",icon:Object(f.jsx)(Z.a,{}),content:"This operation cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",centered:!0,onOk:function(){return Object(d.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D({method:"POST",url:"/leaveAllChatroom"});case 3:e({type:g.LEAVE_ALL_ROOMS}),e({type:E.LEAVE_ROOM}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},onCancel:function(){console.log("Cancel")}})},children:"Leave All Rooms"}),Object(f.jsx)(K.a,{title:"Create a Room",visible:v,centered:!0,okText:"Create",onCancel:function(){return x(!1)},destroyOnClose:!0,footer:Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(h.a,{onClick:function(){return x(!1)},children:"Cancel"}),Object(f.jsx)(h.a,{type:"primary",onClick:function(){return T()},loading:N,children:"Create"})]}),children:Object(f.jsxs)(b.a,{form:i,requiredMark:!1,className:"form",labelAlign:"right",labelCol:{span:6},wrapperCol:{span:12},children:[Object(f.jsx)(b.a.Item,{name:"roomName",label:"Name",rules:[{required:!0,message:"This field cannot be empty"}],children:Object(f.jsx)(m.a,{placeholder:"Room Name"})}),Object(f.jsx)(b.a.Item,{name:"roomSize",label:"Size",initialValue:10,rules:[{required:!0,message:"This field cannot be empty"},{validator:function(e,t){return null!==t&&(+t<2||+t>70)?Promise.reject(new Error("Invalid size")):Promise.resolve()}}],children:Object(f.jsx)(xe.a,{min:2,max:70})}),Object(f.jsx)(b.a.Item,{name:"isPrivate",label:"Is Private",valuePropName:"checked",initialValue:!0,children:Object(f.jsx)(ge.a,{})})]})})]})}function Ne(e){return Object(f.jsxs)("div",{className:"room ".concat(e.isActive&&"active"),onClick:function(){return!e.isActive&&e.onClick(e.id)},children:[Object(f.jsx)(Q.a,{dot:e.hasNewMessage,children:Object(f.jsx)(J.a,{size:48,shape:"square",style:{backgroundColor:ie(e.id%8)},children:e.name.split(" ").map((function(e){return e[0]})).join("").slice(0,2)})}),Object(f.jsxs)("div",{className:"info",children:[Object(f.jsx)("span",{className:"name",children:e.name}),Object(f.jsx)("br",{}),e.isPrivate?Object(f.jsx)(Oe.a,{color:"blue",children:"Private"}):Object(f.jsx)(Oe.a,{color:"green",children:"Public"})]})]})}var Ie=n(398),Te=n(400),_e=n(403),Re=n(391),Ae=n(81),Ce=n(411);function Le(e){var t=Object(s.b)(),n=Object(s.c)((function(e){return e.user.user})),a=Object(s.c)((function(e){return e.room})),c=a.currentRoom,o=a.blockedUsers,i=a.normalUsers,l=a.isAdmin,O=a.fetchUsersLoading,b=Object(r.useState)([]),m=Object(j.a)(b,2),p=m[0],v=m[1],x=Object(r.useState)(!1),g=Object(j.a)(x,2),y=g[0],S=g[1],N=Object(r.useState)(!1),I=Object(j.a)(N,2),T=I[0],_=I[1],R=function(){var e=Object(d.a)(u.a.mark((function e(n,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:E.FETCH_USERS_LOADING}),e.next=4,D({method:"POST",url:r?"/blockUser":"/unblockUser",body:{user:n,chatRoomId:c.chatRoomId}});case 4:je.b.success("Operation succeeded"),t(fe(c.chatRoomId)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),A=function(){var e=Object(d.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D({method:"POST",url:"/removeUser",body:{user:n,chatRoomId:c.chatRoomId}});case 3:je.b.success("Operation succeeded"),t(fe(c.chatRoomId)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),C=function(n,r){return Object(f.jsxs)(Ie.a,{children:[!n&&Object(f.jsx)(Ie.a.Item,{onClick:function(){t({type:E.SET_PRIVATE_MESSAGE,payload:r}),e.onClose()},children:"Private Message"},1),l&&Object(f.jsxs)(f.Fragment,{children:[n?Object(f.jsx)(Ie.a.Item,{onClick:function(){return R(r.userId,!1)},children:"Unblock"},3):Object(f.jsx)(Ie.a.Item,{onClick:function(){return R(r.userId,!0)},children:"Block"},2),Object(f.jsx)(Ie.a.Item,{onClick:function(){return A(r.userId)},children:"Remove from room"},4)]})]},r.userId)},L=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),_(!0),e.prev=2,e.next=5,D({method:"GET",url:"/getListofUserToInvite/".concat(c.chatRoomId)});case 5:t=e.sent,n=t.data,v(n||[]),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0.message);case 13:return e.prev=13,_(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[2,10,13,16]])})));return function(){return e.apply(this,arguments)}}();return Object(f.jsxs)(Te.a,{className:"room-drawer",placement:"right",getContainer:!1,visible:e.visible,onClose:e.onClose,closable:!1,style:{position:"absolute"},children:[Object(f.jsxs)("div",{style:{position:"relative"},children:[O&&Object(f.jsx)(ye,{}),Object(f.jsxs)("section",{children:[Object(f.jsx)("h3",{children:"Room Members"}),i.map((function(e){return Object(f.jsxs)("div",{className:"user",children:[Object(f.jsx)(J.a,{src:e.userAvatar,style:{backgroundColor:ie(e.userId%oe)},children:e.userName[0]}),Object(f.jsx)("span",{className:"name",children:e.userName}),e.userId===n.id?Object(f.jsx)(Oe.a,{color:"blue",style:{marginLeft:"auto"},children:"You"}):Object(f.jsx)(_e.a,{overlay:C(!1,e),placement:"bottomLeft",children:Object(f.jsx)(h.a,{type:"link",icon:Object(f.jsx)(Ce.a,{}),style:{marginLeft:"auto"}})})]},e.userId)})),l&&c.isPrivate&&Object(f.jsx)("div",{style:{textAlign:"center"},children:Object(f.jsx)(h.a,{type:"dashed",icon:Object(f.jsx)(Ee.a,{}),onClick:function(){return L()},children:"Invite Member"})})]}),Object(f.jsxs)("section",{style:{marginTop:"2rem"},children:[Object(f.jsx)("h3",{children:"Blocked List"}),o.map((function(e){return Object(f.jsxs)("div",{className:"user",children:[Object(f.jsx)(J.a,{src:e.userAvatar,style:{backgroundColor:ie(e.userId%oe)},children:e.userName[0]}),Object(f.jsx)("span",{className:"name",children:e.userName}),e.userId===n.id?Object(f.jsx)(Oe.a,{color:"blue",style:{marginLeft:"auto"},children:"You"}):Object(f.jsx)(_e.a,{overlay:C(!0,e),placement:"bottomLeft",children:Object(f.jsx)(h.a,{type:"link",icon:Object(f.jsx)(Ce.a,{}),style:{marginLeft:"auto"}})})]},e.userId)}))]})]}),Object(f.jsx)("div",{style:{marginTop:"2rem",textAlign:"center"},children:Object(f.jsx)(h.a,{type:"primary",danger:!0,onClick:function(){K.a.confirm({title:"Are you sure to leave this room?",icon:Object(f.jsx)(Ae.a,{}),content:"This operation cannot be undone.",okText:"Yes",okType:"danger",cancelText:"No",centered:!0,onOk:function(){var n;e.onClose(),t((n=c.chatRoomId,function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D({method:"POST",url:"/leaveChatRoom",body:{chatRoomId:n}});case 3:return t({type:E.LEAVE_ROOM}),e.next=6,W("my")(t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()))},onCancel:function(){console.log("Cancel")}})},children:"Leave Room"})}),Object(f.jsx)(K.a,{visible:y,onCancel:function(){return S(!1)},closable:!0,title:"Invite Members",centered:!0,footer:null,width:300,children:Object(f.jsxs)("div",{className:"member-modal",children:[T&&Object(f.jsx)(ye,{}),p.map((function(e){return Object(f.jsxs)("div",{className:"user",children:[Object(f.jsx)(J.a,{src:e.userAvatar,style:{backgroundColor:ie(e.userId%oe)},children:e.userName[0]}),Object(f.jsx)("span",{className:"name",children:e.userName}),Object(f.jsx)(Re.a,{title:"Confirm to send invitation",onConfirm:Object(d.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D({method:"POST",url:"/sendInvite",body:{user:e.userId,chatRoomId:c.chatRoomId}});case 3:je.b.success("Invitation Sent"),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0.message);case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))),okText:"Invite",cancelText:"Cancel",children:Object(f.jsx)(h.a,{type:"primary",size:"small",style:{marginLeft:"auto"},icon:Object(f.jsx)(Ee.a,{}),children:"Invite"})})]},e.userId)}))]})})]})}function ke(e){var t=Object(s.b)(),n=Object(s.c)((function(e){return e.user})),a=n.isAuthenticated,c=n.user,o=Object(s.c)((function(e){return e.room})).currentRoom,l=Object(r.useState)(!1),u=Object(j.a)(l,2),d=u[0],O=u[1];return a?c?Object(f.jsx)(v,{children:Object(f.jsxs)("div",{className:"main",children:[Object(f.jsx)(le,Object(y.a)({},e)),Object(f.jsx)(Se,{}),Object(f.jsx)(ve,{openDrawer:function(){t(fe(o.chatRoomId)),O(!0)}}),Object(f.jsx)(Le,{visible:d,onClose:function(){return O(!1)}})]})}):Object(f.jsx)(v,{children:Object(f.jsx)(q.a,{size:"large",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}})}):Object(f.jsx)(i.a,{to:"/login"})}je.b.config({top:180,duration:2});var we=n(406),Me=n(394),Ue=n(412),Pe=n(413),Ge=n(414),De=n(415),Fe=n(416),He=(n(386),["jed","joe","jack","jess","jodi","jacques","jordan","josephine","jude","jon","jazabelle","julie","jean","jabala","jaqueline","jenni","jeri","jia","jai","jolee","jane","josh","jana","jeane","jerry","jake","james","jocelyn"]);function Ve(e){var t=Object(s.b)(),n=Object(s.c)((function(e){return e.user})),a=n.isAuthenticated,c=n.isLoading,o=Object(p.useForm)(),i=Object(j.a)(o,1)[0],l=Object(r.useState)({}),x=Object(j.a)(l,2),g=x[0],E=x[1],y=Object(r.useState)(0),S=Object(j.a)(y,2),N=S[0],I=S[1],T=Object(r.useState)(""),_=Object(j.a)(T,2),R=_[0],A=_[1],C=Object(r.useState)(!1),L=Object(j.a)(C,2),k=L[0],w=L[1];Object(r.useEffect)((function(){a&&e.history.push("/main")}),[a]);var M=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.validateFields();case 2:n=e.sent,1===t&&E(i.getFieldsValue()),n&&I(N+t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(d.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.validateFields();case 2:e.sent&&((n=i.getFieldsValue()).age=+n.age,t(H(Object.assign({},n,g))));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=[Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(b.a.Item,{name:"username",rules:[{required:!0,message:"This field cannot be empty"}],children:Object(f.jsx)(m.a,{placeholder:"Username",size:"large",prefix:Object(f.jsx)(O.g,{})})}),Object(f.jsx)(b.a.Item,{name:"password",rules:[{required:!0,message:"This field cannot be empty"}],children:Object(f.jsx)(m.a,{type:"password",placeholder:"Password",size:"large",prefix:Object(f.jsx)(O.d,{})})}),Object(f.jsx)(b.a.Item,{name:"confirm",rules:[{required:!0,message:"This field cannot be empty"},function(e){var t=e.getFieldValue;return{validator:function(e,n){return n&&t("password")!==n?Promise.reject(new Error("The two passwords that you entered do not match!")):Promise.resolve()}}}],children:Object(f.jsx)(m.a,{type:"password",placeholder:"Confirm",size:"large",prefix:Object(f.jsx)(O.d,{})})}),Object(f.jsxs)("div",{style:{marginTop:"3rem"},children:[Object(f.jsx)(h.a,{type:"primary",shape:"round",size:"large",icon:Object(f.jsx)(Ue.a,{style:{marginRight:"1rem"}}),style:{width:"8rem",height:"3rem"},onClick:function(){return M(1)},children:"Next"}),Object(f.jsx)(h.a,{type:"link",size:"large",onClick:function(){return e.history.push("/login")},children:"Login"})]})]}),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(b.a.Item,{name:"imageUrl",rules:[{required:!0,message:"This field cannot be empty"},{type:"url",message:"Invalid Url"}],children:Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(m.a,{type:"hidden"}),Object(f.jsx)(Y.a,{placement:"bottomRight",visible:k,content:Object(f.jsx)(f.Fragment,{children:He.map((function(e){return Object(f.jsx)("span",{onClick:function(){i.setFieldsValue({imageUrl:"https://joeschmoe.io/api/v1/".concat(e)}),A("https://joeschmoe.io/api/v1/".concat(e)),w(!1)},children:Object(f.jsx)(J.a,{src:"https://joeschmoe.io/api/v1/".concat(e)})},e)}))}),children:Object(f.jsx)("div",{style:{display:"inline-block"},onClick:function(){return w(!0)},children:Object(f.jsx)(J.a,{className:"avatar",size:60,src:R,icon:Object(f.jsx)(Pe.a,{})})})})]})}),Object(f.jsx)(b.a.Item,{name:"age",rules:[{required:!0,message:"This field cannot be empty"},{validator:function(e,t){return+t<10||+t>70?Promise.reject(new Error("Invalid age")):Promise.resolve()}}],children:Object(f.jsx)(m.a,{type:"number",max:70,min:10,placeholder:"Age",size:"large",prefix:Object(f.jsx)(Ge.a,{})})}),Object(f.jsx)(b.a.Item,{name:"interests",rules:[{required:!0,message:"This field cannot be empty"}],children:Object(f.jsx)(m.a,{placeholder:"Interests",size:"large",prefix:Object(f.jsx)(De.a,{})})}),Object(f.jsx)(b.a.Item,{name:"school",rules:[{required:!0,message:"This field cannot be empty"}],children:Object(f.jsx)(m.a,{placeholder:"School Name",size:"large",prefix:Object(f.jsx)(O.e,{})})}),Object(f.jsxs)(we.b,{style:{marginTop:"3rem"},children:[Object(f.jsx)(h.a,{type:"ghost",shape:"round",size:"large",style:{width:"8rem",height:"3rem"},icon:Object(f.jsx)(Fe.a,{style:{marginRight:"1rem"}}),onClick:function(){return M(-1)},children:"Back"}),Object(f.jsx)(h.a,{type:"primary",shape:"round",size:"large",style:{minWidth:"8rem",height:"3rem"},onClick:function(){return U()},loading:c,children:"Register"})]})]})];return Object(f.jsx)(v,{children:Object(f.jsxs)("div",{className:"register",children:[Object(f.jsxs)("div",{className:"left",children:[Object(f.jsx)("h1",{children:"Register"}),Object(f.jsxs)(Me.a,{direction:"vertical",current:N,children:[Object(f.jsx)(Me.a.Step,{title:"Create Username and Password"}),Object(f.jsx)(Me.a.Step,{title:"Choose Avatar and enter info"})]}),Object(f.jsx)(b.a,{form:i,requiredMark:!1,className:"form",children:P[N]},0)]}),Object(f.jsx)("div",{className:"right"})]})})}var ze=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.user.user})),n=Object(s.c)((function(e){return e.user.isAuthenticated})),a=Object(s.c)((function(e){return e.user.token}));return Object(r.useEffect)((function(){a&&!t&&e(V(a))}),[]),Object(f.jsxs)(o.a,{hashType:"slash",children:[Object(f.jsx)(i.b,{path:"/*",children:n?Object(f.jsx)(i.a,{to:"/main"}):Object(f.jsx)(i.a,{to:"/login"})}),Object(f.jsx)(i.b,{path:"/login",exact:!0,component:B}),Object(f.jsx)(i.b,{path:"/register",exact:!0,component:Ve}),Object(f.jsx)(i.b,{path:"/main",exact:!0,component:ke})]})};n(387);c.a.render(Object(f.jsx)(s.a,{store:U,children:Object(f.jsx)(ze,{})}),document.getElementById("root"))}},[[388,1,2]]]);
//# sourceMappingURL=main.ec89a2f1.chunk.js.map